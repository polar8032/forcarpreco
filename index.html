<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Ajuste Profissional</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; padding: 15px; display: flex; justify-content: center; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 450px; }
        
        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #e8f0fe; }
        .tab { flex: 1; padding: 10px; text-align: center; cursor: pointer; font-weight: bold; color: #666; }
        .tab.active { color: #1a73e8; border-bottom: 3px solid #1a73e8; }
        
        table { width: 100%; border-collapse: collapse; }
        td { padding: 8px 5px; }
        label { font-size: 0.85rem; color: #444; font-weight: 600; }
        input { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        
        .result-box { background-color: #fff4f4; margin-top: 15px; padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #d93025; }
        .result-label { font-size: 0.8rem; color: #d93025; text-transform: uppercase; font-weight: bold; }
        .result-val { font-size: 1.8rem; font-weight: bold; color: #d93025; }
        
        .btn-limpar { width: 100%; margin-top: 10px; padding: 10px; background-color: #6c757d; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="card">
    <div class="tabs">
        <div class="tab active" onclick="switchTab('unidade')">Unitário</div>
        <div class="tab" onclick="switchTab('peso')">Ao Peso (Kg)</div>
    </div>

    <div id="modoUnidade">
        <table>
            <tr><td><label>Preço base antes de forçar (€)</label></td>
                <td><input type="number" id="baseUn" step="0.01" oninput="calcUn()"></td></tr>
            <tr><td><label>Preço atual na caixa (€)</label></td>
                <td><input type="number" id="caixaUn" step="0.01" oninput="calcUn()"></td></tr>
            <tr><td><label>Preço pretendido (€)</label></td>
                <td><input type="number" id="alvoUn" step="0.01" oninput="calcUn()"></td></tr>
        </table>
    </div>

    <div id="modoPeso" class="hidden">
        <table>
            <tr><td><label>Peso do artigo (Kg)</label></td>
                <td><input type="number" id="pesoKg" step="0.001" placeholder="Ex: 0.550" oninput="calcPeso()"></td></tr>
            <tr><td><label>Preço Base por Kg no PC (€)</label></td>
                <td><input type="number" id="basePeso" step="0.01" placeholder="Ex: 10.00" oninput="calcPeso()"></td></tr>
            <tr><td><label>Valor que deu na caixa (€)</label></td>
                <td><input type="number" id="caixaPeso" step="0.01" oninput="calcPeso()"></td></tr>
            <tr><td><label>Valor que pretendes (€)</label></td>
                <td><input type="number" id="alvoPeso" step="0.01" oninput="calcPeso()"></td></tr>
        </table>
    </div>

    <div class="result-box">
        <div class="result-label" id="resLabel">Novo Preço Base a Marcar</div>
        <div id="resultado" class="result-val">0.00 €</div>
    </div>

    <button class="btn-limpar" onclick="limpar()">Limpar Tudo</button>
</div>

<script>
    let currentTab = 'unidade';

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        event.currentTarget.classList.add('active');
        
        document.getElementById('modoUnidade').classList.toggle('hidden', tab !== 'unidade');
        document.getElementById('modoPeso').classList.toggle('hidden', tab !== 'peso');
        document.getElementById('resLabel').innerText = tab === 'unidade' ? "Novo Preço Base" : "Novo Preço Base / Kg";
        limpar();
    }

    function calcUn() {
        const b = parseFloat(document.getElementById('baseUn').value);
        const c = parseFloat(document.getElementById('caixaUn').value);
        const a = parseFloat(document.getElementById('alvoUn').value);
        if (b && c && a) {
            document.getElementById('resultado').innerText = (a / (c / b)).toFixed(2) + " €";
        }
    }

    function calcPeso() {
        const peso = parseFloat(document.getElementById('pesoKg').value);
        const baseKg = parseFloat(document.getElementById('basePeso').value);
        const valorCaixa = parseFloat(document.getElementById('caixaPeso').value);
        const valorAlvo = parseFloat(document.getElementById('alvoPeso').value);

        if (peso && baseKg && valorCaixa && valorAlvo) {
            // Primeiro descobrimos o preço real por kg que a caixa está a cobrar (com desconto)
            const precoRealKgComDesconto = valorCaixa / peso;
            // Coeficiente de desconto = Preço Real com Desconto / Preço Base do PC
            const coeficiente = precoRealKgComDesconto / baseKg;
            // Preço final por kg que queremos atingir
            const precoAlvoKg = valorAlvo / peso;
            // Novo preço base a marcar no PC
            const novoBaseKg = precoAlvoKg / coeficiente;
            
            document.getElementById('resultado').innerText = novoBaseKg.toFixed(2) + " €/Kg";
        }
    }

    function limpar() {
        document.querySelectorAll('input').forEach(i => i.value = '');
        document.getElementById('resultado').innerText = '0.00 €';
    }
</script>

</body>
</html>
